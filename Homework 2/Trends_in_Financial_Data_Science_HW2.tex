\documentclass[11pt]{article}

\usepackage{amsmath,amsthm,amssymb}

%%%%% Matrix stretcher
% use it as:
%\begin{pmatrix}[1.5]
% ...
\makeatletter
\renewcommand*\env@matrix[1][\arraystretch]{%
  \edef\arraystretch{#1}%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols c}}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\extrafootertext[1]{%
    \bgroup
    \renewcommand\thefootnote{\fnsymbol{footnote}}%
    \renewcommand\thempfootnote{\fnsymbol{mpfootnote}}%
    \footnotetext[0]{#1}%
    \egroup
}


%%%%%%%%%%%%% Colors %%%%%%%%%%%%%
\usepackage[dvipsnames]{xcolor}

\definecolor{C0}{HTML}{1d1d1d}
\definecolor{C1}{HTML}{1e3668}
\definecolor{C2}{HTML}{199d8b}
\definecolor{C3}{HTML}{d52f4c}
\definecolor{C4}{HTML}{5ab2d6}
\definecolor{C5}{HTML}{ffb268}
\definecolor{C6}{HTML}{ff7300} % for commenting - {fire orange}dd571c
\definecolor{C7}{HTML}{777b7e} % for remarks - {steel grey}
\color{C0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%% Fonts %%%%%%%%%%%%% 
%\usepackage{fontspec}
\usepackage[no-math]{fontspec} % for text

\emergencystretch=8pt
\hyphenpenalty=1000 % default 50
\tolerance=800      % default 200
%\righthyphenmin=4
%\lefthyphenmin=4

%%% Text Font: Vollkorn + Math Font: Latin Modern (default) %%%
\setmainfont{Vollkorn}[
UprightFont = Vollkorn-Regular,
ItalicFont =Vollkorn-Italic, 
BoldItalicFont={Vollkorn-BoldItalic},
BoldFont = Vollkorn-Bold,
RawFeature=+lnum,
WordSpace=1.7,
] 

%%% We need this for math font packages other than latin modern %%%
% \usepackage{unicode-math}        % for math

%%% Text Font: Palatino + Math Font: Asana-Math %%%
%\setmainfont{Palatino}[
%BoldFont = Palatino-Bold,
%ItalicFont = Palatino-Italic,
%BoldItalicFont={Palatino-BoldItalic},
%RawFeature=+lnum,
%WordSpace=1.7,
%]
%\setmathfont{asana-math}

%%% Text Font: Arno Pro + Math Font: Minion Pro %%%
%\setmainfont{Arno Pro}[
%UprightFont = *-Regular,
%ItalicFont = Vollkorn-Italic, 
%BoldItalicFont={*-BoldItalic},
%BoldFont = *-Bold,
%RawFeature=+lnum,
%WordSpace=1.7,
%Scale= 1.1
%] 
% Minion Pro is too expensive

%%% Math Fonts %%%
%\setmathfont{Vollkorn}
%\setmathfont{Latin Modern Math}
%\setmathfont{TeX Gyre Pagella Math}
%\setmathfont{TeX Gyre Termes Math}
%\setmathfont{TeX Gyre DejaVu Math}
%\setmathfont[Scale=MatchLowercase]{DejaVu Math TeX Gyre}
%\setmathfont{XITS Math}
%\setmathfont{Libertinus Math}
%\setmathfont[Scale=MatchUppercase]{Asana Math}
%\setmathfont{STIX Two Math}

%\usepackage{kpfonts-otf}
%\setmathfont{KpMath-Regular.otf}[version=regular]
%\setmathfont{KpMath-Bold.otf}[version=bold]
%\setmathfont{KpMath-Semibold.otf}[version=semibold]
%\setmathfont{KpMath-Sans.otf}[version=sans]
%\setmathfont{KpMath-Light.otf}[version=light]


%%% CJK Fonts %%%
\usepackage[scale=.78]{luatexja-fontspec}
\setmainjfont{BabelStone Han}[AutoFakeBold]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% This package simplifies the insertion of external multi-page PDF or PS documents.
\usepackage{pdfpages}

% cref
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=C4,
    filecolor=magenta,      
    urlcolor=cyan,
    }

\usepackage[nameinlink,noabbrev,capitalize]{cleveref}
% \crefname{ineq}{}{}
% \crefname{equation}{}{}
% \creflabelformat{ineq}{#2{\textup{(1)}}#3}
% \creflabelformat{equation}{#2\textup{(#1)}#3}

%%%%%%%%%%%%% Environments %%%%%%%%%%%%%%%%
%amsthm has three separate predefined styles:	
%
%\theoremstyle{plain} is the default. it sets the text in italic and adds extra space above and below the \newtheorems listed below it in the input. it is recommended for theorems, corollaries, lemmas, propositions, conjectures, criteria, and (possibly; depends on the subject area) algorithms.
%
%\theoremstyle{definition} adds extra space above and below, but sets the text in roman. it is recommended for definitions, conditions, problems, and examples; i've alse seen it used for exercises.
%
%\theoremstyle{remark} is set in roman, with no additional space above or below. it is recommended for remarks, notes, notation, claims, summaries, acknowledgments, cases, and conclusions.

%%%  theorem-like environment %%%
\theoremstyle{plain} % default theorem style
\newtheorem{theorem}{Theorem}[section]
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{property}[theorem]{Property}

\newtheorem{definition}[theorem]{Definition}

%%% definition-like environment %%%
%\theoremstyle{definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{problem}[theorem]{Problem}


%%% framed package is great %%%
\usepackage{framed}
\newenvironment{solution}
{\color{C2}\normalfont\begin{framed}\begingroup\textbf{Solution:} }
  {\endgroup\end{framed}}

\newtheoremstyle{remark}% name of the style to be used
  {}% measure of space to leave above the theorem. E.g.: 3pt
  {}% measure of space to leave below the theorem. E.g.: 3pt
  {\color{C3}}% name of font to use in the body of the theorem
  {}% measure of space to indent
  {\color{C3}\bfseries}% name of head font
  {.}% punctuation between head and body
  { }% space after theorem head; " " = normal interword space
  {}
\theoremstyle{remark}
\newtheorem{remarkx}[theorem]{Remark}
\newenvironment{remark}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\triangle$}\remarkx}
  {\popQED\endremarkx}
  
\newenvironment{point}
  {\O~~}
  {}

\usepackage{thmtools}
\usepackage{thm-restate}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% This package is for the long equal sign \xlongequal{}
\usepackage{extarrows}


% Page Formatting
\usepackage[
    paper=a3paper,
    inner=22mm,         % Inner margin
    outer=22mm,         % Outer margin
    bindingoffset=0mm, % Binding offset
    top=28mm,           % Top margin
    bottom=22mm,        % Bottom margin
    %showframe,         % show how the type block is set on the page
]{geometry}

\setlength{\parindent}{0em}
\setlength{\parskip}{.7em}


\usepackage{tikz}
\usepackage{graphicx}
\usepackage{enumitem}
\setlist{topsep=0pt}

\usepackage{bm}

\usepackage[font=scriptsize,labelfont=bf]{caption}
\usepackage{listings}
\lstset{basicstyle=\ttfamily,breaklines=true}
% \setlength{\parskip}{1em}
% \setlength{\parindent}{0em}
\usepackage{dsfont}
\newcommand{\bOne}{\mathds{1}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\EE}{\mathbb{E}}
\newcommand{\VV}{\mathbb{V}}
\newcommand{\CoV}{\operatorname{Co\mathbb{V}}}

% header
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyhead[L]{\small   \bfseries Homework}
\fancyhead[C]{\small   \bfseries Fall 2023}
\fancyhead[R]{\small   \bfseries Zhou}


\begin{document}

\begin{center}
  \text{\Large{Black-Litterman-Bayes, Kalman Filter, ICA
    }}

  {\text{Kaiwen Zhou}}
\end{center}
\vspace{2em}

\tableofcontents

\section{Topic: Black-Litterman-Bayes}
\begin{problem}
This question refers to the article "On The Bayesian Interpretation Of Black-Litterman" (Kolm and Ritter, EJOR 2017).
\begin{enumerate}[label=(\alph*)]
  \item Derive formulas (10)-(11) using the properties of the multivariate normal distribution in the slides "Bayesian Modeling: Introduction".
  \item \textbf{(Extra credit)} Derive formulas (22)-(26) using the same properties.
\end{enumerate}
\end{problem}
\begin{solution}
  \begin{enumerate}[label=(\alph*)]
    \item Derive formulas (10)-(11) using the properties of the multivariate normal distribution in the slides "Bayesian Modeling: Introduction".
    \item \textbf{(Extra credit)} Derive formulas (22)-(26) using the same properties.
  \end{enumerate}
\end{solution}



\section{Topic: Important Properties Of the Kalman Filter}
\begin{problem}
Choose three out of the four subproblems. It is optional to solve the other one for extra credit.
\begin{enumerate}[label=(\alph*)]
  \item In class we derived the Kalman filter under the assumption that $\mathbb{E}\left[\mathbf{w}_t \mathbf{v}_t^{\prime}\right]=\mathbf{0}$. Now, derive the Kalman filter under the assumption that $\mathbb{E}\left[\mathbf{w}_t \mathbf{v}_t^{\prime}\right]=\mathbf{M}_t$.
  \item Using the notation from class, let us denote the error between the true and estimated states by the random variable $\tilde{\mathbf{x}}_t=\mathbf{x}_t-\hat{\mathbf{x}}_t$. We denote by $\mathbf{W}_t$ a known positive definite matrix. Show that the Kalman filter is the solution to the problem
        \begin{align}
          \min _{\hat{\mathbf{x}}_t} \mathbb{E}\left[\tilde{\mathbf{x}}_t^{\prime} \mathbf{W}_t \tilde{\mathbf{x}}_t\right]\label{eq: kalman}
        \end{align}
  \item Now let us assume that $\mathbf{w}_t$ and $\mathbf{v}_t$ have zero mean, are uncorrelated with covariance matrices $\mathbf{Q}_t$ and $\mathbf{R}_t$, respectively (but they are no longer Gaussian). Show that the Kalman filter is the best linear solution to \cref{eq: kalman}. In other words, the Kalman filter is the best filter that is a linear combination of the measurements, $\mathbf{y}_t$.
  \item In class we derived the Kalman filter under the assumption that $\mathbf{w}_t$ and $\mathbf{v}_t$ are uncolored (i.e. each is serially uncorrelated).
        \begin{enumerate}[label=(\roman*)]
          \item Derive the Kalman filter under the assumption that $\mathbf{w}_t$ is a VAR(1) process with known system matrix.
          \item Derive the Kalman filter under the assumption that $\mathbf{v}_t$ is a $\operatorname{VAR}(1)$ process with known system matrix.
        \end{enumerate}
        Hint: For (d), both (i) and (ii) can be solved by properly augmenting the state equations. Can you find a solution to (ii) where one does not have to augment the state? Is it possible to do so for (i) - why, or why not?
\end{enumerate}

\end{problem}


\section{Topic: Kalman filter's Application on Financial Problems --- Pairs Trading}
\begin{problem}
In this question we consider a basic pairs trading strategy between two stocks with prices $p_t^A$ and $p_t^B$ at time $t$. We denote the spread between them by $s_t:=\log \left(p_t^A\right)-\log \left(p_t^B\right)$ and assume the spread follows an Ornstein-Uhlenbeck process
$$
  d s_t=\kappa\left(\theta-s_t\right) d t+\sigma d B_t
$$
where $d B_t$ is a standard Brownian motion. In other words, the spread reverts to its mean $\theta \in \mathbb{R}$ at the speed $\kappa \in \mathbb{R}_{+}$and volatility $\sigma \in \mathbb{R}_{+}$.
\begin{enumerate}[label=(\alph*)]
  \item Show that the discrete time solution of (2) is Markovian, that is
        $$
          s_k=\mathbb{E}\left[s_k \mid s_{k-1}\right]+\varepsilon_k
        $$
        where $k=1,2, \ldots$, and $\varepsilon_k$ is a random process with zero mean and variance equal to $\sigma_{\varepsilon, k}^2=\mathbb{V}\left[s_k \mid s_{k-1}\right]$. (Hint: You can derive the discrete solution explicitly.)
  \item Propose a methodology for updating the parameters $\theta, \kappa$ using the Kalman filter and describe how you would use it to trade the stock pair.
  \item Test your methodology from (b) on simulated data. In particular, (i) simulate (2) from known parameters $\theta, \kappa$ and $\sigma$, and then (ii) use the Kalman filter to recover them. You do not need to implement the Kalman filter from scratch; you are welcome to use a Kalman implementation from a Python package such as pykalman. How do you obtain a good estimate of $\sigma$ ?
  \item Repeat the same experiment from (c), but this time simulate (2) first with $\kappa$ having the same value as above and then suddenly changing it to another value such that the half-life of the spread is $50 \%$ of its original value. How long does it take the Kalman filter to adjust? Can you make adjustment to your filter in order to speed up the time it takes the Kalman filter to adjust?
\end{enumerate}
Hint: For (c) and (d), think about how you are going to demonstrate the results using appropriate graphs, etc.
\end{problem}

\section{Topic: Kalman filter's Application on Financial Problems --- Index Tracking Portfolios}

\begin{problem}
It is common in portfolio management to build so-called (index) tracking portfolios. Let us assume we are observing the return of the S\&P 500 benchmark index, $r_{b, t}$. Now, let us pick a subset of 50 stocks from the constituents of this index. We will use these stocks to build a tracking portfolio for the index. For example, this could be the 50 companies in the index with the largest market cap. We denote the returns of these 50 stock by $\mathbf{r}_t \in \mathbb{R}^{50}$. The goal of finding a tracking portfolio is to find a dynamic trading strategy of the 50 stocks such that $\boldsymbol{\beta}_t^{\prime} \mathbf{r}_t \approx r_{b, t}$, where $\boldsymbol{\beta}_t$ denotes the holdings of the tracking portfolio.
\begin{enumerate}[label=(\alph*)]
  \item In this part, we assume that the covariance matrix of returns of the stocks in the $\mathrm{S} \& \mathrm{P} 500, \boldsymbol{\Sigma}$, is given and constant through time. Find the portfolio of these 50 stocks that minimizes the tracking error to $r_{b, t}$, i.e. find the solution to
        $$
          \boldsymbol{\beta}_t^*=\operatorname{argmin}_{\boldsymbol{\beta}_t} \sqrt{\mathbb{V}\left[r_{b, t}-\boldsymbol{\beta}_t^{\prime} \mathbf{r}_t\right]} .
        $$

        What specific property does $\boldsymbol{\beta}_t$ have here?
  \item In this part, we no longer assume that covariances amongst stocks are time invariant. Propose a solution to minimizing the tracking error using the Kalman filter.
  \item Download daily market data and create an example that illustrates your methodology. How does the tracking portfolio of the Kalman filter perform?
\end{enumerate}
Hint: For (c), compare your Kalman filter to a solution based on (a) where the covariance matrix is estimated on rolling windows. Can you match the performance of the Kalman filter with the simpler methodology in (a) by appropriately choosing the length of the rolling window?
\end{problem}


\section*{Topic: Another Interpretation for Independent Component Analysis (ICA)}
\begin{problem}
In class we considered the principally-independent component analysis method
which essentially was the truncated rank- $K$ SVD of a matrix X followed by an ICA rotation of the left singular components:
$$
  \mathbf{X} \simeq \mathbf{U S V}^{\prime}=\mathbf{U}_I \mathbf{S}_I \mathbf{V}_I
$$
where $\mathbf{U}_I=\mathbf{U} \mathbf{A}_I$ with $\mathbf{A}_I=\underset{\mathbf{A}, \mathbf{A}^{\prime} \mathbf{A}=I_K}{\operatorname{argmax}}\left|k_{\ell}(\mathbf{U A})\right|, k_{\ell}(\mathbf{G})$ being any centered cumulant of order $\ell \geq 3$ which for all practical purposes can be considered a non-linear (activation)

function applied to each of the entries of $\mathbf{G}$. Furthermore the matrix $\mathbf{V}_I$ was defined as $\mathbf{V}_I^{\prime}:=\mathbf{D}^{-1} \mathbf{S}^{-1} \mathbf{A}_I \mathbf{S} \mathbf{V}^{\prime}$ where $\mathbf{D}$ was chosen so that $\mathbf{V}_I$ has unimodular columns.
\begin{enumerate}[label=(\alph*)]
  \item Show that $\mathbf{D}$ is a diagonal matrix
  \item Show that $\mathbf{S}_I=\mathbf{S D}$ is diagonal such that $\operatorname{Tr}\left(\mathbf{S}_I^2\right)=\operatorname{Tr}\left(\mathbf{S}^2\right)$.
  \item Show that the method can be derived as the limit, $\lambda^2 \rightarrow 0$, of the optimization
        $$
          \mathbf{U}_I, \mathbf{S}_I, \mathbf{V}_I=\underset{\mathbf{P}, \mathbf{Q}: \mathbf{P}^{\prime} \mathbf{P}=\operatorname{diag}\left(\mathbf{Q}^{\prime} \mathbf{Q}\right)=\mathbf{I}_k}{\operatorname{argmin}}\left\|\mathbf{X}-\mathbf{P R Q}^{\prime}\right\|_F-\lambda^2\left|k_{\ell}(\mathbf{P})\right| .
        $$
  \item Show that an alternative objective function achieving the same result is
        $$
          \mathbf{U}_I, \mathbf{S}_I, \mathbf{V}_I=\underset{\mathbf{P}, \mathbf{Q}: \mathbf{P}^{\prime} \mathbf{P}=\operatorname{diag}\left(\mathbf{Q}^{\prime} \mathbf{Q}\right)=\mathbf{I}_k}{\operatorname{argmin}}\left\|\mathbf{X}-\mathbf{P R Q}^{\prime}\right\|_F-\lambda^2 J(\mathbf{P}),
        $$
        where $J[\mathbf{x}]:=H\left[\mathbf{x}_{\text {gauss }}\right]-H[\mathbf{x}]$ is the negentropy and $J(\mathbf{P})$ is the sum of the negentropies of all the columns of $\mathbf{P}$.
\end{enumerate}
\end{problem}


























\end{document}

